Bootstrap: localimage
From: deps.sif


%environment
    . "$HOME/.cargo/env"

%files
<<<<<<< HEAD
    ../src /src/bascet/src
=======
    ../src        /src/bascet/src
    ../.cargo     /src/bascet/.cargo
>>>>>>> main
    ../Cargo.toml /src/bascet/Cargo.toml

%post
    SINGULARITY_SHELL=/bin/bash

    ### build bascet
    . "$HOME/.cargo/env"
    cd /src/bascet
<<<<<<< HEAD
    #cargo +nightly build --profile=release
    cargo +nightly build

    ### link bascet to where it should be
    #cp /src/bascet/target/release/bascet /bin/bascet
    cp /src/bascet/target/debug/bascet /bin/bascet
=======
    cargo +nightly build --profile=release
    #cargo +nightly build

    ### link bascet to where it should be
    cp /src/bascet/target/release/bascet /bin/bascet
    #cp /src/bascet/target/debug/bascet /bin/bascet
>>>>>>> main

    ### cleanup
    rm -Rf /src/bascet

%runscript
    exec "$@"
